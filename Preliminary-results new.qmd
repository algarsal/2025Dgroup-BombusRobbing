---
title: "Nectar robbing by *Bombus terrestris* and its effects on pollination"
author: "Vikas Nehra; Sina Mesri; Guillem Soler; Rolf Siebert"
affiliation: "Universitat Politècnica de València"
title-block-banner: true
date: last-modified
date-format: iso
lang: en-US
language:
  title-block-published: "Last modified"        
format: html
execute:
  echo: true
  warning: false
  message: false
embed-resources: true
self-contained-math: true
---

<div style="text-align:center; margin-bottom:20px;">
  <img src="https://www.upv.es/perfiles/pas-pdi/imagenes/marca_UPV_principal_blanco300.png"
       width="180">
</div>

## Introduction

Nectar robbing occurs when floral visitors access nectar without effectively contributing to pollination, typically by bypassing contact with the reproductive structures of the flower. In invaded communities, Bombus terrestris has emerged as a particularly important nectar robber, frequently piercing the corollas of Fuchsia magellanica to extract nectar while providing little or no pollination service. This behavior can reduce nectar availability in individual flowers and potentially modify the foraging decisions of native pollinators, such as hummingbirds, which rely on nectar as a primary energy source.

Biological invasions are increasingly recognized as a major driver of change in mutualistic networks, where plants and pollinators are linked through reciprocal dependence on rewards and pollination. The introduction of B. terrestris adds a novel interaction mode—systematic nectar robbing—that may weaken the quantity or quality of pollination that native plants receive, even when flowers continue to be visited. Within this context, Fuchsia magellanica, a nectar‑rich, hummingbird‑pollinated shrub, provides an ideal model system to examine how invasive nectar robbers can restructure plant–pollinator interactions. The central questions are whether nectar robbing by B. terrestris depletes floral nectar sufficiently to alter the visitation patterns of native hummingbirds and other visitors, and whether any such changes ultimately reduce seed set.

To address these questions, the study quantifies nectar production and standing nectar crop in robbed and unrobbed flowers, characterizes shifts in the frequency and type of visits by native pollinators and other floral visitors, and estimates female reproductive success through seed production. By jointly considering behavioral responses and reproductive outcomes, the project offers a nuanced view of invasion impacts that goes beyond simple presence–absence effects. It highlights that invasive species may substantially modify the structure and function of native mutualisms at the behavioral level while producing more subtle or context‑dependent consequences for plant fitness, thereby providing a framework to assess how novel interaction modes, such as nectar robbing, can uncouple short‑term disruption of mutualisms from longer‑term demographic effects on native plants.

## Objectives and hypotheses

### Objective 1:
Assess whether nectar robbing alters visitation by native pollinators.

### Objective 2:
Evaluate whether nectar robbing affects seed production.

### Hypotheses:

- **H1**: Flowers experiencing nectar robbing receive fewer native visits.
- **H2**: Nectar robbing negatively affects seed set.

## Methods

### Data origin

We used publicly available data from a PeerJ study on nectar robbing by *Bombus terrestris*. The dataset contains flower-level observations across populations, including visitation rates, nectar traits, and seed production.

# 1. Packages

```{r}
library(dplyr)
library(ggplot2)
library(readxl)
library(MASS)
library(knitr)
```



# 2. Data import 

```{r}
url <- "https://dfzljdn9uc3pi.cloudfront.net/2025/20253/1/Raw_data.xlsx"
tmp <- tempfile(fileext = ".xlsx")

tryCatch(
download.file(url, tmp, mode = "wb"),
error = function(e) stop("Data download failed. Check internet connection.")
)

df <- read_excel(tmp)
```



# 3. Data preparation

```{r}
df <- df %>%
  mutate(
    rob_count = as.numeric(`Total robbing visits (visits/flower/10 min)`),
    native_visits =
      as.numeric(`Total pollinating visits (visits/flower/10 min)`) -
      as.numeric(`Pollinating visits by B. terrestris (visits/flower/10 min)`),
    Population = factor(Population),
    robbed = ifelse(rob_count > 0, "Robbed", "Unrobbed"),
    visited = ifelse(native_visits > 0, "Visited", "Not visited")
  ) %>%
  filter(!is.na(native_visits), !is.na(rob_count))

```


# 4. Zero structure 

```{r}
zero_table <- df %>%
group_by(robbed) %>%
summarise(
flowers = n(),
zero_visits = sum(native_visits == 0),
proportion_zero = zero_visits / flowers
)

kable(zero_table, digits = 2,
caption = "Zero inflation of native visits by nectar robbing status")
```



# 5. Was the flower visited or not?

```{r}
df %>%
count(robbed, visited) %>%
group_by(robbed) %>%
mutate(prop = n / sum(n)) %>%
ggplot(aes(visited, prop, fill = robbed)) +
geom_col(position = "dodge") +
labs(
x = "Visitation status",
y = "Proportion of flowers",
title = "Effect of nectar robbing on visitation probability"
) +
theme_minimal()
```

# 6. Intensity of visits 

```{r}
df %>%
filter(native_visits > 0) %>%
ggplot(aes(native_visits, fill = robbed)) +
geom_histogram(binwidth = 1, position = "dodge") +
labs(
x = "Native visits per flower",
y = "Number of flowers",
title = "Intensity of native visits (visited flowers only)"
) +
theme_minimal()
```




# 7. Count model

```{r}
mod_pois <- glm(
native_visits ~ rob_count + Population,
family = poisson,
data = df
)

summary(mod_pois)
```



# 8. Model-based prediction 

```{r}
newdat <- data.frame(
rob_count = seq(0, max(df$rob_count), length.out = 100),
Population = levels(df$Population)[1]
)

newdat$pred <- predict(mod_pois, newdat, type = "response")

ggplot(df, aes(rob_count, native_visits)) +
geom_jitter(alpha = 0.4, width = 0.1) +
geom_line(data = newdat, aes(rob_count, pred),
linewidth = 1, color = "red") +
labs(
x = "Robbing visits",
y = "Native visits",
title = "Negative relationship between nectar robbing and native visitation"
) +
theme_minimal()

```


## Discussion

Our results indicate that nectar robbing is associated with a higher proportion of flowers receiving no native visits and a reduced intensity of visitation when visits occur. The Poisson model supports a negative relationship between robbing frequency and native visitation, consistent with the hypothesis that nectar depletion discourages native pollinators.

## Conclusions

Nectar robbing by *Bombus terrestris* alters pollination dynamics by reducing both the probability and intensity of native pollinator visits. These effects may have cascading consequences for plant reproductive success and the stability of pollination networks.
